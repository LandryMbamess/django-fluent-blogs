{% extends "fluent_blogs/base.html" %}
{% load i18n comments %}

{% block title %}{{ object.title }}{% endblock %}

{% block meta-description %}{% if object.excerpt %}{{ object.excerpt|striptags }}{% else %}{{ object.content|striptags|truncatewords:100 }}{% endif %}{% endblock %}

{% block meta-keywords %}{% if object.tags %}{{ object.tags }}{% else %}{{ block.super }}{% endif %}{% endblock %}

{% block link %}
  {{ block.super }}
  {% with object.previous_entry as previous_entry %}{% if previous_entry %}
    <link rel="prev" title="{{ previous_entry.title }}" href="{{ previous_entry.get_absolute_url }}" />
  {% endif %}{% endwith %}
  {% with object.next_entry as next_entry %}{% if next_entry %}
    <link rel="next" title="{{ next_entry.title }}" href="{{ next_entry.get_absolute_url }}" />
  {% endif %}{% endwith %}
  {% if object.short_url %}
    <link rel="shortlink" href="{{ object.short_url }}" />
  {% endif %}
  <link rel="canonical" href="{{ object.get_absolute_url }}" />

  {% comment %}
  {% with object.creation_date|date:"Y" as year %}
    {% with object.creation_date|date:"m" as month %}
      {% with object.creation_date|date:"d" as day %}
        <link rel="alternate" type="application/rss+xml" title="{% trans "RSS Feed of discussions on" %} '{{ object.title }}'"
              href="{% url zinnia_entry_discussion_feed year month day object.slug %}" />
        <link rel="alternate" type="application/rss+xml" title="{% trans "RSS Feed of comments on" %} '{{ object.title }}'"
              href="{% url zinnia_entry_comment_feed year month day object.slug %}" />
        <link rel="alternate" type="application/rss+xml" title="{% trans "RSS Feed of pingbacks on" %} '{{ object.title }}'"
              href="{% url zinnia_entry_pingback_feed year month day object.slug %}" />
        <link rel="alternate" type="application/rss+xml" title="{% trans "RSS Feed of trackbacks on" %} '{{ object.title }}'"
              href="{% url zinnia_entry_trackback_feed year month day object.slug %}" />
      {% endwith %}
    {% endwith %}
  {% endwith %}
  {% endcomment %}
{% endblock %}

{% block content %}
  <div id="entry-{{ object.pk }}" class="hentry{% if object.featured %} featured{% endif %} span-16 last">
    {% with object.html_content|safe as object_content %}
      {% include "fluent_blogs/entry_list/item.html" %}
    {% endwith %}
  </div>

  <hr />

  <div class="entry-widgets">
    {% with object.next_entry as next_entry %}
      {% if next_entry %}
        <div class="entry-next">
          <h3>{% trans "Next entry" %}</h3>
          <ul>
            <li>
              <a href="{{ next_entry.get_absolute_url }}" title="{{ next_entry.title }}" rel="next">
                {{ next_entry.title }}
              </a>
            </li>
          </ul>
        </div>
      {% endif %}
    {% endwith %}
    {% with object.previous_entry as previous_entry %}
      {% if previous_entry %}
        <div class="entry-previous">
          <h3>{% trans "Previous entry" %}</h3>
          <ul>
            <li>
              <a href="{{ previous_entry.get_absolute_url }}" title="{{ previous_entry.title }}" rel="prev">
                {{ previous_entry.title }}
              </a>
            </li>
          </ul>
        </div>
      {% endif %}
    {% endwith %}
    {% if object.related_published %}
      <div class="entry-related">
        <h3>{% trans "Related entries" %}</h3>
        <ul>
          {% for entry in object.related_published %}
            <li>
              <a href="{{ entry.get_absolute_url }}" title="{{ entry.title }}" rel="bookmark">{{ entry.title }}</a>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </div>

  <div id="comments">
    <h3>{% trans "Comments" %}</h3>

    {% with object.comments as comment_list %}
      {% if comment_list.count %}
        {% render_comment_list for object %}

        {% if not object.comments_are_open %}
          <p>{% trans "Comments are closed." %}</p>
        {% endif %}
      {% else %}
        {% if object.comments_are_open %}
          <p>{% trans "No comments yet." %}</p>
        {% else %}
          <p>{% trans "Comments are closed." %}</p>
        {% endif %}
      {% endif %}
    {% endwith %}
  </div>

  {% if object.comments_are_open %}
    <div class="commentForm">
      {% render_comment_form for object %}
    </div>
  {% endif %}
{% endblock %}
